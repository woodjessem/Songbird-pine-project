M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Nt+((K-Tnt)/(K))*(M-I)*Nt
#T is the sum of all n abundances, this incorporated below
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
Tnt<-sum(n[1,])
for (yr in 2:tmax) {
D[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
K=200
tmax=50 #using same time frame as in questions above, 50 yrs.
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0 #make first row the initial population vector
#same f1,f2,s0,s1,s2 values as above, not retyped
#same M matrix as above, but defined again here, just in case chunks separated
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Equation: Nt+((K-Tnt)/(K))*(M-I)*Nt
Q=as.numeric() # Q=quotient term (K-Tnt)/K
Tnt<-sum(n[1,]) #T is the sum of all n abundances
for (yr in 2:tmax) {
Q[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(Q)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
K=200
tmax=50 #using same time frame as in questions above, 50 yrs.
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0 #make first row the initial population vector
#same f1,f2,s0,s1,s2 values as above, not retyped
#same M matrix as above, but defined again here, just in case chunks separated
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Equation: Nt+((K-Tnt)/(K))*(M-I)*Nt
Q=as.numeric() # Q=quotient term (K-Tnt)/K
Tnt<-sum(n[1,]) #T is the sum of all n abundances
for (yr in 2:tmax) {
Q[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(Q)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="Years")
library(spatstat)
library(spatstat)
library(sp)
library(rgdal)
library(maptools)
rare=readOGR(".", "Rare")
plot(rare)
rare.ppm<-as(rare,"ppp")
class(rare.ppm)
env.plot=envelope(test,Kest,nsim=99)
test<-ppm(rare.ppm ~1)
env.plot=envelope(test,Kest,nsim=99)
library(ppmlasso)
test<-ppm(rare.ppm ~1)
summary(test)
env.plot<-envelope(test, Kest, nsim=99)
plot(env.plot)
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology/Movement_lab")
library(moveHMM)
library(moveHMM)
library(tseries)
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology/Movement_lab")
library(moveHMM)
library(tseries)
rawBuffalo <- read.csv("Buffalo.csv")
head(rawBuffalo)
processedBuffalo <- prepData(rawBuffalo,type="UTM")
processedBuffalo
View(processedBuffalo)
buffalo<-subset(processedBuffalo,step>0,select="ID:temp")
buffalo<-subset(processedBuffalo,step>0,select=ID:temp)
subbuffalo<-subset(processedBuffalo,step>0,select=ID:temp)
buffalosub<-subset(processedBuffalo,step>0,select=ID:temp)
buffalosub
View(buffalosub)
plot(buffalosub)
summary(buffalosub$step)
sd(buffalosub$step)
summary(buffalosub$step) #1st quart
mu0 <- c(28,400) # step mean (two parameters: one for each state)
sigma0 <- c(0.5,1) # step SD
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0) # angle mean
kappa0 <- c(0.7,1.5) # angle concentration
anglePar0 <- c(angleMean0,kappa0)
beta0 <- matrix(c(-3,1,0.3,-0.5,-0.01,0.01),nrow=3,byrow=TRUE)
summary(buffalosub$angle) #min , 1st quart , 3rd quart , max
sd(buffalosub$angle)
summary(buffalosub$angle) #min -3.142, 1st quart -1.043, 3rd quart 1.016, max 3.142
m1 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~1) # no covariate
m2 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~temp) # covariate 'temp'
print(AIC(m1,m2))
plot(m1)
plot(m2)
buffalosub<-subset(processedBuffalo,step>0 & step<60,000,select=ID:temp)
buffalosub
View(buffalosub)
processedBuffalo <- prepData(rawBuffalo,type="UTM")
rawBuffalo <- read.csv("Buffalo.csv")
processedBuffalo <- prepData(rawBuffalo,type="UTM")
buffalosub<-subset(processedBuffalo,step>0 & step<60,000,select=ID:temp)
buffalosub
View(buffalosub)
rawBuffalo <- read.csv("Buffalo.csv")
processedBuffalo <- prepData(rawBuffalo,type="UTM")
buffalosub<-subset(processedBuffalo,step>0 & step<60000,select=ID:temp)
View(buffalosub)
plot(buffalosub)
summary(buffalosub$step) #min 0.82, 1st quart 28.80, 3rd quart 400.50, max 63100.00
sd(buffalosub$step)  #839.6601
summary(buffalosub$angle) #min -pi, 1st quart -1.043, 3rd quart 1.016, max pi  #mean -0.0105
mu0 <- c(20,400) # step mean (two parameters: one for each state)
sigma0 <- c(0.5,1) # step SD
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0) # angle mean
kappa0 <- c(0.7,1.5) # angle concentration - idk for this data
anglePar0 <- c(angleMean0,kappa0)
beta0 <- matrix(c(-3,1,0.3,-0.5,-0.01,0.01),nrow=3,byrow=TRUE)
m1 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~1) # no covariate
m2 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~temp) # covariate 'temp'
print(AIC(m1,m2))
plot(m1)
states <- viterbi(m1)
mu0 <- c(20,10000) # step mean (two parameters: one for each state)
sigma0 <- c(0.5,1) # step SD
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0) # angle mean
kappa0 <- c(0.7,1.5) # angle concentration - idk for this data
anglePar0 <- c(angleMean0,kappa0)
beta0 <- matrix(c(-3,1,0.3,-0.5,-0.01,0.01),nrow=3,byrow=TRUE)
m1 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~1) # no covariate
m2 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~temp) # covariate 'temp'
print(AIC(m1,m2))
plot(m1)
states <- viterbi(m1)
mu0 <- c(20,10000) # step mean (two parameters: one for each state)
sigma0 <- c(200,700) # step SD
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0) # angle mean
kappa0 <- c(0.7,1.5) # angle concentration - idk for this data
anglePar0 <- c(angleMean0,kappa0)
beta0 <- matrix(c(-3,1,0.3,-0.5,-0.01,0.01),nrow=3,byrow=TRUE)
m1 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~1) # no covariate
m2 <- fitHMM(data=buffalosub,nbStates=2,stepPar0=stepPar0,anglePar0=anglePar0, formula=~temp) # covariate 'temp'
plot(m1)
states <- viterbi(m1)
cat("Proportion of the time spent in state 2:",length(which(states==2))/length(states),"\n")
res <- pseudoRes(m1)
print(jarque.bera.test(res$step[which(!is.na(res$step))]))
print(jarque.bera.test(res$angle[which(!is.na(res$angle))]))
print(AIC(m1,m2))
res<-pseudoRes(m2)
print(jarque.bera.test(res$step[which(!is.na(res$step))]))  #issue with Nas
print(jarque.bera.test(res$angle[which(!is.na(res$angle))])) #worked
res <- pseudoRes(m1)
# normality test for step pseudo-residuals
print(jarque.bera.test(res$step[which(!is.na(res$step))]))  #issue with Nas
# normality test for angle pseudo-residuals
print(jarque.bera.test(res$angle[which(!is.na(res$angle))])) #worked
res<-pseudoRes(m2)
# normality test for step pseudo-residuals
print(jarque.bera.test(res$step[which(!is.na(res$step))]))  #issue with Nas
# normality test for angle pseudo-residuals
print(jarque.bera.test(res$angle[which(!is.na(res$angle))])) #worked
states <- viterbi(m1)
cat("Proportion of the time spent in state 2:",length(which(states==2))/length(states),"\n")
states <- viterbi(m2)
states <- viterbi(m2)
cat("Proportion of the time spent in state 2:",length(which(states==2))/length(states),"\n")
plot(m2)
head(rawBuffalo) #only four necessary columns
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology")
library(spdep)
library(GISTools)
library(rgdal)
library(lattice)
library(maps)
library(maptools)
library(raster)
example(columbus)
?columbus
crime=(columbus$CRIME-min(columbus$CRIME))/max(columbus$CRIME)
hoval=(columbus$HOVAL-min(columbus$HOVAL))/max(columbus$HOVAL)
inc=(columbus$INC-min(columbus$INC))/max(columbus$INC)
plot(columbus,col=gray(1-crime))
plot(columbus,col=gray(1-hoval))
crime=(columbus$CRIME-min(columbus$CRIME))/max(columbus$CRIME)
hoval=(columbus$HOVAL-min(columbus$HOVAL))/max(columbus$HOVAL)
inc=(columbus$INC-min(columbus$INC))/max(columbus$INC)
plot(columbus,col=gray(1-crime))
plot(columbus,col=gray(1-hoval))
plot(columbus,col=gray(1-inc))
moran.test(columbus$CRIME,randomisation=FALSE, nb2listw(col.gal.nb,style="W"))
?nb2listw
?col.gal.nb
columbus.lm=lm(CRIME ~ INC + HOVAL,data=columbus)
summary(columbus.lm)
res=resid(columbus.lm)
res=(res-min(res))/diff(range(res))
plot(columbus,col=gray(1-res))
lm.morantest(columbus.lm,nb2listw(col.gal.nb,style="W"))
col.listw=nb2listw(col.gal.nb,style="W")
?col.listw
??col.listw
?nb2listw
col.listw
crime.sar=spautolm(CRIME ~ INC + HOVAL, data=columbus,col.listw,family="SAR")
summary(crime.sar)
col.list.car=similar.listw(col.listw)
crime.car=spautolm(CRIME ~ INC + HOVAL,data=columbus, col.list.car,family="CAR")
summary(crime.car)
col.listw=nb2listw(col.gal.nb,style="S") #changed to S second time thru (was W first)
crime.sar=spautolm(CRIME ~ INC + HOVAL, data=columbus,col.listw,family="SAR")
summary(crime.sar)
col.list.car=similar.listw(col.listw)
crime.car=spautolm(CRIME ~ INC + HOVAL,data=columbus, col.list.car,family="CAR")
summary(crime.car)
dam=readOGR(".", "dams00x020")
head(dam)
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed output
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(dams,randomisation=FALSE, nb2listw(col.gal.nb,style="W"))
head(dams)
moran.test(dam,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
head(dam)
moran.test(states,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
moran.test(dam$DAMS00X020,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
moran.test(dam$CITY,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology")
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology")
library(spdep)
library(geoR)
library(GISTools)
library(rgdal)
library(lattice)
library(maps)
library(maptools)
library(raster)
example(columbus)
?columbus
dam=readOGR(".", "dams00x020")
head(dam)
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?nb2listw
moran.test(num.dam,randomisation=FALSE, nb2listw(col.gal.nb,style="S")) #dam$something
moran.test(num.dam,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(neigh.car,style="S")) #dam$something
dam.lists=nb2listw(neigh.car,style="S") #S or W
class(num.dam)
dam.lists=nb2listw(neigh.car,style="S") #S or W
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(neigh.car,style="S")) #dam$something
dam=readOGR(".", "dams00x020")
head(dam)   #longitude, latitude, county, city, OWN type, dam type, purposes, height, surf area, hazard, drain area, symbol, etc. lots of potential "covariates" but which make sense?
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
moran.test(dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
head(dam)   #longitude, latitude, county, city, OWN type, dam type, purposes, height, surf area, hazard, drain area, symbol, etc. lots of potential "covariates" but which make sense?
moran.test(dam$SURF_AREA,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
dam.lm=lm(SURF_AREA ~ NID_HEIGHT,data=dam)
summary(dam.lm)
dam.lists=nb2listw(neigh.car,style="S") #S or W
damstuff.car=spautolm(SURF_AREA ~ NID_HEIGHT,data=num.dam, dam.list.car,family="CAR")
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S"))
head(states)
dam.lists=nb2listw(neigh.car,style="S") #S or W
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.car,family="CAR")
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, boarder.share,family="CAR")
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
dam.lists=nb2listw(neigh.car,style="S") #S or W
neigh.car=nb2listw(neigh,style="S")
dam.lists=nb2listw(neigh.car,style="W") #S or W
damstuff.car=spautolm(num.dam ~ states$AREA,data=states,  nb2listw(boarder.share,style="W"),family="CAR")
dam.lists=nb2listw(boarder.share,style="W") #S or W
dam.list.car=similar.listw(dam.lists)
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.car,family="CAR")
summary(damstuff.car)
head(states)
dam.listw=nb2listw(boarder.share,style="W") #S or W
dam.list.car=similar.listw(dam.listw)
dam.list.carw=similar.listw(dam.listw)
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.carw,family="CAR")
summary(damstuffw.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
damstuffw.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.carw,family="CAR")
summary(damstuffw.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
dam.lm=lm(num.dam ~ states$AREA,data=states)
summary(dam.lm)
lm.morantest(dam.lm,nb2listw(dam.listw,style="W")) #even once included, still SAC! #S or W
lm.morantest(dam.lm,dam.list.carw) #even once included, still SAC! #S or W
dam.lists=nb2listw(boarder.share,style="S") #S or W
dam.list.cars=similar.listw(dam.lists)
damstuffs.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.cars,family="CAR")
summary(damstuffs.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
moran.test(num.dam,randomisation=FALSE, dam.lists)
dam.lm=lm(num.dam ~ states$AREA,data=states)
summary(dam.lm) #uhhh... significance
lm.morantest(dam.lm,dam.list.cars)  #p-value 0.1955 indicates no clustering (no spatial autocorrelation)
install.packages("SDMTools")
?PatchStat
??PatchStat
library(raster)
library(rgdal)
ras <- raster("C:/Users/woodj/Desktop/raster3")
ras <- raster("C:/Users/woodj/Desktop/sraster3")
ps.data = PatchStat(ras, cellsize=100, latlon=TRUE)
library(SDMTools)
library(sp)
ras <- raster("C:/Users/woodj/Desktop/sraster3")
ps.data = PatchStat(ras, cellsize=100, latlon=TRUE)
ps.data = PatchStat(ras, cellsize=100, latlon=FALSE) #true didn't like my coordinates
ps.data
setwd("~/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology/Final Project")
write.table(ps.data, file="C:C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology/Final Project/patchstatresults.xls",sep="\t")
write.table(ps.data, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology/Final Project/patchstatresults.xls",sep="\t")
View(ps.data)
library("unmarked")
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds")
prwa.abund<- csvToUMF("prwa_abund.csv", long = FALSE, type = "unmarkedFramePCount")
str(prwa.abund)
obsCovs(prwa.abund)= scale (obsCovs(prwa.abund))
sc <- siteCovs(prwa.abund)
sc[,c(5:60)] <- scale(sc[, c(5:60)]) #from 26 to 60 now with landscape variables
siteCovs(prwa.abund) <- sc
null2.prwa <- pcount(~ Jdate ~1, prwa.abund, mixture="NB", K=20)
global2.prwa <- pcount(~ Jdate ~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + Age + Nburns + Nthins + TimeSinceB + TimeSinceT
+ HWdens_50 + FG_herb + FG_shrub + NHW_saplings + NP_over_20cm
+ Rel_HW2P_canopy + LCR
, prwa.abund, mixture="NB", K=20)
local2.prwa <- pcount(~ Jdate ~ BA + Ccover + TreeHt + Ldepth, prwa.abund, mixture="NB", K=20)
lh2.prwa <- pcount(~ Jdate ~ Age + TimeSinceB + FG_herb + HWdens_50 + NHW_saplings, prwa.abund, mixture="NB", K=20)
landmetrics.prwa <- pcount (~ Jdate ~ Parea + ShapeIndex + PAratio + FracDimIndex + CoreAreaIndex, prwa.abund, mixture="NB",K=20)
landscape500.prwa <- pcount(~ Jdate ~ Evergreen500m + Grass500m + HighDev500m + Schrubs500m, prwa.abund, mixture="NB", K=20)
landscape1.prwa <- pcount(~ Jdate ~ Evergreen1km + Grass1km + HighDev1km + Schrubs1km, prwa.abund, mixture="NB", K=20)
landscape5.prwa <- pcount(~ Jdate ~ Evergreen5km + Grass5km + HighDev5km + Schrubs5km, prwa.abund, mixture="NB", K=20)
landscape30.prwa <- pcount(~ Jdate ~ Evergreen30km + Grass30km + HighDev30km + Schrubs30km, prwa.abund, mixture="NB", K=20)
treatment2.prwa <- pcount(~ Jdate ~ Treatment + Nthins, prwa.abund, mixture ="NB", K=20)
management2.prwa <- pcount(~ Jdate ~ Treatment + BA + TimeSinceB + TimeSinceT + Herbicide, prwa.abund, mixture="NB", K=20)
disturbance2.prwa <- pcount(~ Jdate ~ TimeSinceB + TimeSinceT, prwa.abund, mixture="NB", K=20)
fms3 <- fitList(null2.prwa, local2.prwa, lh2.prwa, landmetrics.prwa, landscape500.prwa, landscape1.prwa
landscape5.prwa, landscape30.prwa, treatment2.prwa, management2.prwa, disturbance2.prwa)
fms3 <- fitList(null2.prwa, local2.prwa, lh2.prwa, landmetrics.prwa, landscape500.prwa, landscape1.prwa,
landscape5.prwa, landscape30.prwa, treatment2.prwa, management2.prwa, disturbance2.prwa)
ms3.prwa <- modSel(fms3) #note this does not include global
ms3.prwa
ms3.prwa@Full
write.table(ms3.prwa@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/prwa_top_models_ms3_with_landscape.xls",sep="\t")
landscape5.prwa
