crime.sar=spautolm(CRIME ~ INC + HOVAL, data=columbus,col.listw,family="SAR")
summary(crime.sar)
col.list.car=similar.listw(col.listw)
crime.car=spautolm(CRIME ~ INC + HOVAL,data=columbus, col.list.car,family="CAR")
summary(crime.car)
dam=readOGR(".", "dams00x020")
head(dam)
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed output
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(dams,randomisation=FALSE, nb2listw(col.gal.nb,style="W"))
head(dams)
moran.test(dam,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
head(dam)
moran.test(states,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
moran.test(dam$DAMS00X020,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
moran.test(dam$CITY,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology")
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Classes/Spatial Ecology")
library(spdep)
library(geoR)
library(GISTools)
library(rgdal)
library(lattice)
library(maps)
library(maptools)
library(raster)
example(columbus)
?columbus
dam=readOGR(".", "dams00x020")
head(dam)
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.sar=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?nb2listw
moran.test(num.dam,randomisation=FALSE, nb2listw(col.gal.nb,style="S")) #dam$something
moran.test(num.dam,randomisation=FALSE, nb2listw(col.gal.nb,style="W")) #dam$something
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="W")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=3)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(neigh.car,style="S")) #dam$something
dam.lists=nb2listw(neigh.car,style="S") #S or W
class(num.dam)
dam.lists=nb2listw(neigh.car,style="S") #S or W
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(neigh.car,style="S")) #dam$something
dam=readOGR(".", "dams00x020")
head(dam)   #longitude, latitude, county, city, OWN type, dam type, purposes, height, surf area, hazard, drain area, symbol, etc. lots of potential "covariates" but which make sense?
class(dam)
plot(dam)
proj4string(dam)
proj4string(dam)=CRS("+proj=longlat +ellps=WGS84")
data(tornados)
states=spTransform(us_states,CRS(proj4string(dam)))
num.dam=poly.counts(dam,states)
names(num.dam)=as.character(states$STATE_NAME)
states$num.dam=num.dam
head(num.dam)
class(num.dam)
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
moran.test(dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
head(dam)   #longitude, latitude, county, city, OWN type, dam type, purposes, height, surf area, hazard, drain area, symbol, etc. lots of potential "covariates" but which make sense?
moran.test(dam$SURF_AREA,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S")) #dam$something
dam.lm=lm(SURF_AREA ~ NID_HEIGHT,data=dam)
summary(dam.lm)
dam.lists=nb2listw(neigh.car,style="S") #S or W
damstuff.car=spautolm(SURF_AREA ~ NID_HEIGHT,data=num.dam, dam.list.car,family="CAR")
moran.test(num.dam,randomisation=FALSE, nb2listw(boarder.share,style="S"))
head(states)
dam.lists=nb2listw(neigh.car,style="S") #S or W
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.car,family="CAR")
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, boarder.share,family="CAR")
?knn2nb
centers=coordinates(gCentroid(states,byid=TRUE))
neigh=knn2nb(knearneigh(centers,k=4)) #try k=3 and k=4 #idea was to see how they changed CAR model
plot(neigh,centers)
neigh.car=nb2listw(neigh,style="S")
boarder.share=poly2nb(states) #another way to specify a neighborhood
plot(boarder.share,coordinates(states))
dam.lists=nb2listw(neigh.car,style="S") #S or W
neigh.car=nb2listw(neigh,style="S")
dam.lists=nb2listw(neigh.car,style="W") #S or W
damstuff.car=spautolm(num.dam ~ states$AREA,data=states,  nb2listw(boarder.share,style="W"),family="CAR")
dam.lists=nb2listw(boarder.share,style="W") #S or W
dam.list.car=similar.listw(dam.lists)
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.car,family="CAR")
summary(damstuff.car)
head(states)
dam.listw=nb2listw(boarder.share,style="W") #S or W
dam.list.car=similar.listw(dam.listw)
dam.list.carw=similar.listw(dam.listw)
damstuff.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.carw,family="CAR")
summary(damstuffw.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
damstuffw.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.carw,family="CAR")
summary(damstuffw.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
dam.lm=lm(num.dam ~ states$AREA,data=states)
summary(dam.lm)
lm.morantest(dam.lm,nb2listw(dam.listw,style="W")) #even once included, still SAC! #S or W
lm.morantest(dam.lm,dam.list.carw) #even once included, still SAC! #S or W
dam.lists=nb2listw(boarder.share,style="S") #S or W
dam.list.cars=similar.listw(dam.lists)
damstuffs.car=spautolm(num.dam ~ states$AREA,data=states, dam.list.cars,family="CAR")
summary(damstuffs.car)  #There is no spatial autocorrelation in the number of dams data with respect to state area (p-value 0.55607, lambda 0.29113).  #AIC 591.39
moran.test(num.dam,randomisation=FALSE, dam.lists)
dam.lm=lm(num.dam ~ states$AREA,data=states)
summary(dam.lm) #uhhh... significance
lm.morantest(dam.lm,dam.list.cars)  #p-value 0.1955 indicates no clustering (no spatial autocorrelation)
library("unmarked")
setwd("C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds")
bf.abund<- csvToUMF("Behavior_bf_pcount.csv", long = FALSE, type = "unmarkedFramePCount")
str(bf.abund)
obsCovs(bf.abund)= scale (obsCovs(bf.abund))
sc <- siteCovs(bf.abund)
sc[,c(5:74)] <- scale(sc[, c(5:74)]) #from 26 to 74 +landscape+soils
siteCovs(bf.abund) <- sc
testP.bf <- pcount(~1 ~1, bf.abund, mixture="P", K=50)
testNB.bf <- pcount(~1 ~1, bf.abund, mixture="NB", K=50)
fmsTEST <- fitList(testP.bf, testNB.bf)
msTEST.bf <- modSel(fmsTEST)
msTEST.bf
det.null.bf <- pcount(~1 ~1, bf.abund, mixture="P", K=50)
det.weather.bf <- pcount(~ Wind + Sky ~1, bf.abund, mixture="P", K=50)
det.global.bf <- pcount(~ Jdate + Wind + Sky + Noise +Time ~1, bf.abund, mixture="P", K=50)
det.sound.bf <- pcount(~ Noise + Wind ~1, bf.abund, mixture="P", K=50)
det.date.bf <- pcount(~ Jdate ~1, bf.abund, mixture="P", K=50)
det.detect.bf <- pcount(~ Jdate + Noise + Time ~1, bf.abund, mixture="P", K=50)
det.notdate.bf <-pcount(~ Wind + Sky + Noise ~1, bf.abund, mixture="P", K=50)
det.time.bf <-pcount(~ Time ~1, bf.abund, mixture="P",K=50)
det.timing.bf <-pcount(~ Time + Jdate ~1, bf.abund, mixture="P", K=50)
fmsDC <- fitList(det.null.bf, det.weather.bf, det.global.bf,
det.sound.bf, det.date.bf, det.detect.bf, det.notdate.bf,
det.time.bf, det.timing.bf)
msDC.bf <- modSel(fmsDC)
msDC.bf
det.timing.bf
confint(det.timing.bf, type="state",method="normal")
write.table(msDC.bf@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_bf_top_models_msDC.xls",sep="\t")
null.bf <- pcount(~ Time + Jdate ~1, bf.abund, mixture="P", K=80)
global.bf <- pcount(~ Time + Jdate
~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + Age + TimeSinceB + TimeSinceT + Nthins + Nburns
+ HW_dens_1050 + NP_over_20cm
+ Rel_HW2P_canopy + PISoils  + NSoilTypes
+ Parea + ShapeIndex
, bf.abund, mixture="P", K=80) #+ FPSiteIndex
local.bf <- pcount(~ Time + Jdate
~ Ccover + TreeHt + Ldepth
, bf.abund, mixture="P", K=80) #can only include BA OR CCover
lh.bf <- pcount(~ Time + Jdate
~ Age + TreeHt + BA + NP_over_20cm + Nsnags + Rel_HW2P_canopy
, bf.abund, mixture="P", K=80)
landmetrics.bf <- pcount (~ Time + Jdate
~ Parea + ShapeIndex
, bf.abund, mixture="P",K=80)
landscape500.bf <- pcount(~ Time + Jdate
~ Evergreen500m + HighDev500m + Schrubs500m
, bf.abund, mixture="P", K=80)
landscape1.bf <- pcount(~ Time + Jdate
~ Evergreen1km + HighDev1km + Schrubs1km
, bf.abund, mixture="P", K=80)
landscape5.bf <- pcount(~ Time + Jdate
~ Evergreen5km + HighDev5km + Schrubs5km
, bf.abund, mixture="P", K=80)
landscape30.bf <- pcount(~ Time + Jdate
~ Evergreen30km + HighDev30km + Protected30km
, bf.abund, mixture="P", K=80)
treatment.bf <- pcount(~ Time + Jdate
~ Treatment + Nthins
, bf.abund, mixture ="P", K=80)
management.bf <- pcount(~ Time + Jdate
~ Treatment + BA + TimeSinceB + TimeSinceT + Herbicide
, bf.abund, mixture="P", K=80)
disturbance.bf <- pcount(~ Time + Jdate
~ TimeSinceB + TimeSinceT
, bf.abund, mixture="P", K=80)
siteprod.bf <- pcount(~ Time + Jdate ~ PISoils + NSoilTypes
, bf.abund, mixture="P", K=80)    #FPSiteIndex
fmsBF <- fitList(null.bf, global.bf, local.bf, lh.bf, landmetrics.bf,
landscape500.bf, landscape1.bf, landscape5.bf, landscape30.bf,
treatment.bf, management.bf, disturbance.bf,
siteprod.bf)  #no greenberg
ms.bf <- modSel(fmsBF)
ms.bf
landscape30.bf
confint(landscape30.bf, type="state",method="normal")
write.table(ms.bf@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_bf_top_models_ms.xls",sep="\t")
fg.abund<- csvToUMF("Behavior_fg_pcount.csv", long = FALSE, type = "unmarkedFramePCount")
str(fg.abund)
sc <- siteCovs(fg.abund)
sc[,c(5:74)] <- scale(sc[, c(5:74)]) #from 26 to 74 +landscape+soils
siteCovs(fg.abund) <- sc
testP.fg <- pcount(~1 ~1, fg.abund, mixture="P", K=50)
testNB.fg <- pcount(~1 ~1, fg.abund, mixture="NB", K=50)
fmsTEST <- fitList(testP.fg, testNB.fg)
msTEST.fg <- modSel(fmsTEST)
msTEST.fg
det.null.fg <- pcount(~1 ~1, fg.abund, mixture="P", K=50)
det.weather.fg <- pcount(~ Wind + Sky ~1, fg.abund, mixture="P", K=50)
det.global.fg <- pcount(~ Jdate + Wind + Sky + Noise +Time ~1, fg.abund, mixture="P", K=50)
det.sound.fg <- pcount(~ Noise + Wind ~1, fg.abund, mixture="P", K=50)
det.date.fg <- pcount(~ Jdate ~1, fg.abund, mixture="P", K=50)
det.detect.fg <- pcount(~ Jdate + Noise + Time ~1, fg.abund, mixture="P", K=50)
det.notdate.fg <-pcount(~ Wind + Sky + Noise ~1, fg.abund, mixture="P", K=50)
det.time.fg <-pcount(~ Time ~1, fg.abund, mixture="P",K=50)
det.timing.fg <-pcount(~ Time + Jdate ~1, fg.abund, mixture="P", K=50)
fmsDC <- fitList(det.null.fg, det.weather.fg, det.global.fg,
det.sound.fg, det.date.fg, det.detect.fg, det.notdate.fg,
det.time.fg, det.timing.fg)
msDC.fg <- modSel(fmsDC)
msDC.fg
det.notdate.fg
confint(det.notdate.fg, type="state",method="normal")
write.table(msDC.fg@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_fg_top_models_msDC.xls",sep="\t")
global.bf <- pcount(~ Time + Jdate
~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + Age + TimeSinceB + TimeSinceT + Nthins
+ NP_over_20cm
+ Rel_HW2P_canopy + PISoils  + NSoilTypes
+ Parea + ShapeIndex
, bf.abund, mixture="P", K=80) #+ FPSiteIndex
fmsBF <- fitList(null.bf, global.bf, local.bf, lh.bf, landmetrics.bf,
landscape500.bf, landscape1.bf, landscape5.bf, landscape30.bf,
treatment.bf, management.bf, disturbance.bf,
siteprod.bf)  #no greenberg
ms.bf <- modSel(fmsBF)
ms.bf
null.fg <- pcount(~ Time + Jdate ~1, fg.abund, mixture="P", K=80)
global.fg <- pcount(~ Time + Jdate
~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + Age + TimeSinceB + TimeSinceT + Nthins + Nburns
+ HW_dens_1050 + NP_over_20cm
+ Rel_HW2P_canopy + PISoils  + NSoilTypes
+ Parea + ShapeIndex
, fg.abund, mixture="P", K=80) #+ FPSiteIndex
local.fg <- pcount(~ Time + Jdate
~ Ccover + TreeHt + Ldepth
, fg.abund, mixture="P", K=80) #can only include BA OR CCover
lh.fg <- pcount(~ Time + Jdate
~ TreeHt + Ccover + Nsnags + Rel_HW2P_canopy + NHW_saplings + HW_dens_1050
, fg.abund, mixture="P", K=80)
landmetrics.fg <- pcount (~ Time + Jdate
~ Parea + ShapeIndex
, fg.abund, mixture="P",K=80)
landscape500.fg <- pcount(~ Time + Jdate
~ Evergreen500m + OpenDev500m + Schrubs500m + Ag500km
, fg.abund, mixture="P", K=80)
landscape1.fg <- pcount(~ Time + Jdate
~ Evergreen1km + OpenDev1km + Schrubs1km + Ag1km
, fg.abund, mixture="P", K=80)
landscape5.fg <- pcount(~ Time + Jdate
~ Evergreen5km + OpenDev5km + Schrubs5km + Water1km
, fg.abund, mixture="P", K=80)
landscape30.fg <- pcount(~ Time + Jdate
~ Evergreen30km + OpenDev30km + Protected30km
, fg.abund, mixture="P", K=80)
treatment.fg <- pcount(~ Time + Jdate
~ Treatment + Nthins
, fg.abund, mixture ="P", K=80)
management.fg <- pcount(~ Time + Jdate
~ Treatment + BA + TimeSinceB + TimeSinceT + Herbicide
, fg.abund, mixture="P", K=80)
disturbance.fg <- pcount(~ Time + Jdate
~ TimeSinceB + TimeSinceT
, fg.abund, mixture="P", K=80)
siteprod.fg <- pcount(~ Time + Jdate ~ PISoils + NSoilTypes
, fg.abund, mixture="P", K=80)    #FPSiteIndex
fmsFG <- fitList(null.fg, global.fg, local.fg, lh.fg, landmetrics.fg,
landscape500.fg, landscape1.fg, landscape5.fg, landscape30.fg,
treatment.fg, management.fg, disturbance.fg,
siteprod.fg)  #no greenberg
ms.fg <- modSel(fmsFG)
landscape500.fg <- pcount(~ Time + Jdate
~ Evergreen500m + OpenDev500m + Schrubs500m + Ag500m
, fg.abund, mixture="P", K=80)
fmsFG <- fitList(null.fg, global.fg, local.fg, lh.fg, landmetrics.fg,
landscape500.fg, landscape1.fg, landscape5.fg, landscape30.fg,
treatment.fg, management.fg, disturbance.fg,
siteprod.fg)  #no greenberg
ms.fg <- modSel(fmsFG)
ms.fg
disturbance.fg
confint(disturbance.fg, type="state",method="normal")
write.table(ms.fg@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_fg_top_models_ms.xls",sep="\t")
gf.abund<- csvToUMF("Behavior_gf_pcount.csv", long = FALSE, type = "unmarkedFramePCount")
str(gf.abund)
obsCovs(gf.abund)= scale (obsCovs(gf.abund))
sc <- siteCovs(gf.abund)
sc[,c(5:74)] <- scale(sc[, c(5:74)]) #from 26 to 74 +landscape+soils
siteCovs(gf.abund) <- sc
testP.gf <- pcount(~1 ~1, gf.abund, mixture="P", K=50)
testNB.gf <- pcount(~1 ~1, gf.abund, mixture="NB", K=50)
fmsTEST <- fitList(testP.gf, testNB.gf)
msTEST.gf <- modSel(fmsTEST)
msTEST.gf
det.null.gf <- pcount(~1 ~1, gf.abund, mixture="P", K=50)
det.weather.gf <- pcount(~ Wind + Sky ~1, gf.abund, mixture="P", K=50)
det.global.gf <- pcount(~ Jdate + Wind + Sky + Noise +Time ~1, gf.abund, mixture="P", K=50)
det.sound.gf <- pcount(~ Noise + Wind ~1, gf.abund, mixture="P", K=50)
det.date.gf <- pcount(~ Jdate ~1, gf.abund, mixture="P", K=50)
det.detect.gf <- pcount(~ Jdate + Noise + Time ~1, gf.abund, mixture="P", K=50)
det.notdate.gf <-pcount(~ Wind + Sky + Noise ~1, gf.abund, mixture="P", K=50)
det.time.gf <-pcount(~ Time ~1, gf.abund, mixture="P",K=50)
det.timing.gf <-pcount(~ Time + Jdate ~1, gf.abund, mixture="P", K=50)
fmsDC <- fitList(det.null.gf, det.weather.gf, det.global.gf,
det.sound.gf, det.date.gf, det.detect.gf, det.notdate.gf,
det.time.gf, det.timing.gf)
msDC.gf <- modSel(fmsDC)
msDC.gf
det.date.gf
confint(det.date.gf, type="state",method="normal")
write.table(msDC.gf@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_gf_top_models_msDC.xls",sep="\t")
null.fg <- pcount(~ Wind + Sky + Noise ~1, fg.abund, mixture="P", K=80)
global.fg <- pcount(~ Wind + Sky + Noise
~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + Age + TimeSinceB + TimeSinceT + Nthins + Nburns
+ HW_dens_1050 + NP_over_20cm
+ Rel_HW2P_canopy + PISoils  + NSoilTypes
+ Parea + ShapeIndex
, fg.abund, mixture="P", K=80) #+ FPSiteIndex
local.fg <- pcount(~ Wind + Sky + Noise
~ Ccover + TreeHt + Ldepth
, fg.abund, mixture="P", K=80) #can only include BA OR CCover
lh.fg <- pcount(~ Wind + Sky + Noise
~ TreeHt + Ccover + Nsnags + Rel_HW2P_canopy + NHW_saplings + HW_dens_1050
, fg.abund, mixture="P", K=80)
landmetrics.fg <- pcount (~ Wind + Sky + Noise
~ Parea + ShapeIndex
, fg.abund, mixture="P",K=80)
landscape500.fg <- pcount(~ Wind + Sky + Noise
~ Evergreen500m + OpenDev500m + Schrubs500m + Ag500m
, fg.abund, mixture="P", K=80)
landscape1.fg <- pcount(~ Wind + Sky + Noise
~ Evergreen1km + OpenDev1km + Schrubs1km + Ag1km
, fg.abund, mixture="P", K=80)
landscape5.fg <- pcount(~ Wind + Sky + Noise
~ Evergreen5km + OpenDev5km + Schrubs5km + Water1km
, fg.abund, mixture="P", K=80)
landscape30.fg <- pcount(~ Wind + Sky + Noise
~ Evergreen30km + OpenDev30km + Protected30km
, fg.abund, mixture="P", K=80)
treatment.fg <- pcount(~ Wind + Sky + Noise
~ Treatment + Nthins
, fg.abund, mixture ="P", K=80)
management.fg <- pcount(~ Wind + Sky + Noise
~ Treatment + BA + TimeSinceB + TimeSinceT + Herbicide
, fg.abund, mixture="P", K=80)
disturbance.fg <- pcount(~ Wind + Sky + Noise
~ TimeSinceB + TimeSinceT
, fg.abund, mixture="P", K=80)
siteprod.fg <- pcount(~ Wind + Sky + Noise ~ PISoils + NSoilTypes
, fg.abund, mixture="P", K=80)    #FPSiteIndex
fmsFG <- fitList(null.fg, global.fg, local.fg, lh.fg, landmetrics.fg,
landscape500.fg, landscape1.fg, landscape5.fg, landscape30.fg,
treatment.fg, management.fg, disturbance.fg,
siteprod.fg)  #no greenberg
ms.fg <- modSel(fmsFG)
ms.fg
landscape500.fg
confint(landscape500.fg, type="state",method="normal")
write.table(ms.fg@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_fg_top_models_ms.xls",sep="\t")
null.gf <- pcount(~ Jdate ~1, gf.abund, mixture="P", K=80)
global.gf <- pcount(~ Jdate
~ Treatment + Herbicide + BA + Nsnags +Ccover
+ Ldepth + TreeHt + TimeSinceB + TimeSinceT + Nthins
+ HW_dens_1050 + NP_over_20cm + FG_herb + FG_shrub
+ Rel_HW2P_canopy + PISoils  + NSoilTypes
+ Parea + ShapeIndex
, gf.abund, mixture="P", K=80) #+ FPSiteIndex
local.gf <- pcount(~ Jdate
~ Ccover + TreeHt + Ldepth
, gf.abund, mixture="P", K=80) #can only include BA OR CCover
lh.gf <- pcount(~ Jdate
~ FG_herb + FG_shrub + HW_dens_1050 + Ldepth + Rel_HW2P_canopy + BA + NHW_saplings
, gf.abund, mixture="P", K=80)
landmetrics.gf <- pcount (~ Jdate
~ Parea + ShapeIndex
, gf.abund, mixture="P",K=80)
landscape500.gf <- pcount(~ Jdate
~ Evergreen500m + HighDev500m + Schrubs500m + Ag500m
, gf.abund, mixture="P", K=80)
landscape1.gf <- pcount(~ Jdate
~ Evergreen1km + HighDev1km + Schrubs1km + Ag1km
, gf.abund, mixture="P", K=80)
landscape5.gf <- pcount(~ Jdate
~ Evergreen5km + HighDev5km + Schrubs5km
, gf.abund, mixture="P", K=80)
landscape30.gf <- pcount(~ Jdate
~ Evergreen30km + HighDev30km + Protected30km
, gf.abund, mixture="P", K=80)
treatment.gf <- pcount(~ Jdate
~ Treatment + Nthins
, gf.abund, mixture ="P", K=80)
management.gf <- pcount(~ Jdate
~ Treatment + BA + TimeSinceB + TimeSinceT + Herbicide
, gf.abund, mixture="P", K=80)
disturbance.gf <- pcount(~ Jdate
~ TimeSinceB + TimeSinceT
, gf.abund, mixture="P", K=80)
siteprod.gf <- pcount(~ Jdate ~ PISoils + NSoilTypes
, gf.abund, mixture="P", K=80)    #FPSiteIndex
fmsGF <- fitList(null.gf, global.gf, local.gf, lh.gf, landmetrics.gf,
landscape500.gf, landscape1.gf, landscape5.gf, landscape30.gf,
treatment.gf, management.gf, disturbance.gf,
siteprod.gf)  #no greenberg
ms.gf <- modSel(fmsGF)
ms.gf
local.gf
confint(local.gf, type="state",method="normal")
ms.fg
landscape500.fg
confint(landscape500.fg, type="state",method="normal")
write.table(ms.fg@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_fg_top_models_ms.xls",sep="\t")
write.table(ms.gf@Full, file="C:/Users/woodj/Documents/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds/Behavior_gf_top_models_ms.xls",sep="\t")
