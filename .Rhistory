M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=20
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=20
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=50
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=10
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=50
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=40
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=50
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Nt+((K-Tnt)/(K))*(M-I)*Nt
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
K=200
tmax=50
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0
f1=1.1
f2=2.3
s0=0.32
s1=0.42
s2=0.469
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3)
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Nt+((K-Tnt)/(K))*(M-I)*Nt
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum)
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
#plot total abundance over time (go back to lab portion and find that plot of N/n)
# lines 10-75 from above except with this equation instead of what we did there
#xxxxx <-Nt+((K-Tnt)/(K))*(M-I)*Nt ...
#I<-diag(3) #this is used to extract the diagonal values from a 3x3 matrix
#check any other notes, otherwise just read up on online/in Help
#just matrix population model, not projecting forward
library(popdemo)
library(popbio)
# based on info above
f1=1.1 #juvenile fecundity (lower, naturally)
f2=2.3 #adult fecundity (higher)
s0=0.32 #fledgling survival phi (like s0 or G1)
s1=0.42 #juvenile survival phi (like s1 or G2)
s2=0.469 #adult survival phi flood year (like s2 or G3)
n0=c(32,55,100) #initial population vector
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
M
lambda(M)
sensitivity(M)
#just matrix population model, not projecting forward
library(popdemo)
library(popbio)
# based on info above
f1=1.1 #juvenile fecundity (lower, naturally)
f2=2.3 #adult fecundity (higher)
s0=0.32 #fledgling survival phi (like s0 or G1)
s1=0.42 #juvenile survival phi (like s1 or G2)
s2=0.469 #adult survival phi flood year (like s2 or G3)
n0=c(32,55,100) #initial population vector
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
M
lambda(M)
sensitivity(M)
#(Based on the sensitivities, I would have targeted juvenile survival, not adult...)
# s2 needs to be perturbed
#transfer function of asymptotic growth
#evaluate effect of [3,3] - s2 - over range of values for p
tf3 <- tfa(M, d=c(0,0,1), e=c(0,0,1), prange=seq(0,0.2,0.01))
plot(tf3)
#transfer function of population inertia
n0 <- c(32,55,100) #initial population vector
tf4 <- inertia.tfa(M, vector=n0, d=c(0,0,1),
e=c(0,0,1),prange=seq(0,0.2,0.01))
plot(tf4)
n0.amp <- c(32,55,100)
reactivity(M, vector=n0.amp)
maxamp(M, vector=n0.amp)
inertia(M, vector=n0.amp)
plot(project(M,vector=n0.amp,time=50,standard.vec=TRUE,standard.A=TRUE))
n0.destruction <- c(00,55,100) #instead
reactivity(M, vector=n0.destruction)
maxamp(M, vector=n0.destruction)
inertia(M, vector=n0.destruction)
plot(project(M,vector=n0.destruction,time=50,standard.vec=TRUE,standard.A=TRUE))
tf5 <- inertia.tfa(M, vector=n0.destruction, d=c(0,0,1),
e=c(0,0,1),prange=seq(0,0.2,0.01))
plot(tf5)
K=200
tmax=50 #using same time frame as in questions above, 50 yrs.
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0 #make first row the initial population vector
#same f1,f2,s0,s1,s2 values as above, not retyped
#same M matrix as above, but defined again here, just in case chunks separated
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Nt+((K-Tnt)/(K))*(M-I)*Nt
#T is the sum of all n abundances, this incorporated below
D=as.numeric()
for (yr in 2:tmax) {
D[1]=((K-sum(n[1,]))/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
Tnt<-sum(n[1,])
for (yr in 2:tmax) {
D[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(D)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
K=200
tmax=50 #using same time frame as in questions above, 50 yrs.
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0 #make first row the initial population vector
#same f1,f2,s0,s1,s2 values as above, not retyped
#same M matrix as above, but defined again here, just in case chunks separated
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Equation: Nt+((K-Tnt)/(K))*(M-I)*Nt
Q=as.numeric() # Q=quotient term (K-Tnt)/K
Tnt<-sum(n[1,]) #T is the sum of all n abundances
for (yr in 2:tmax) {
Q[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(Q)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="year")
K=200
tmax=50 #using same time frame as in questions above, 50 yrs.
n=matrix(NA,tmax,3)
n0<-c(32,55,100)
n[1,]=n0 #make first row the initial population vector
#same f1,f2,s0,s1,s2 values as above, not retyped
#same M matrix as above, but defined again here, just in case chunks separated
M=matrix(0,3,3)
M[1,1]=f1*s0
M[1,2]=f2*s1
M[1,3]=f2*s2
M[2,1]=s0
M[3,2]=s1
M[3,3]=s2
I=matrix(0,3,3) #three by three matrix, [100,010,001]
I[1,1]=1
I[2,2]=1
I[3,3]=1
I<-diag(3)
#Equation: Nt+((K-Tnt)/(K))*(M-I)*Nt
Q=as.numeric() # Q=quotient term (K-Tnt)/K
Tnt<-sum(n[1,]) #T is the sum of all n abundances
for (yr in 2:tmax) {
Q[1]=((K-Tnt)/K)
n[yr,]=(n[yr-1,])+(Q)*(M-I)%*%n[yr-1,]
}
N=apply(n,1,sum) #add together the abundances in age classes
plot(1:tmax,N,"l",ylim=c(0,max(N)),xlab="Years")
library("unmarked")
setwd("~/GRAD SCHOOL - CLEMSON/Project-Specific/R_Work")
setwd("~/GRAD SCHOOL - CLEMSON/Project-Specific/R work")
setwd("~/GRAD SCHOOL - CLEMSON/Project-Specific/R work/USDA-songbirds/USDA-songbirds")
test <-read.csv("piwa_abund.csv")
summary(test)
str(test)
piwa.abund <- csvToUMF("piwa_abund.csv", long = FALSE, type = "unmarkedFramePCount")
summary(piwa.abund)
null.piwa(~1,~1, data=piwa.abund)
null.piwa<-pcount(~1,~1, data=piwa.abund)
null.piwa <- pcount(~1,~1, data=piwa.abund)
null.piwa <- pcount(~1 ~1, data=piwa.abund)
null.piwa <- pcount(~1 ~1, piwa.abund)
piwa<- csvToUMF("piwa_abund.csv", long = FALSE, type = "unmarkedFramePCount")
summary(piwa)
null.piwa <- pcount(~1 ~1, piwa)
null.piwa <- pcount(~1 ~1, piwa.abund)
piwa.abund2<- csvToUMF("piwa_abund2.csv", long = FALSE, type = "unmarkedFramePCount")
summary(piwa.abund2)
str(piwa.abund2)
test <-read.csv("piwa_abund2.csv")
summary(test)
str(test)
test <-read.csv("piwa_abund.csv")
summary(test)
str(test) #y.4 and Noise.4 and Wind.4 and Sky.4 JDate.4 are factors and shouldn't be
piwa.abund<- csvToUMF("piwa_abund.csv", long = FALSE, type = "unmarkedFramePCount")
##type may need to change for occupancy (occuRN, pcountOpen, or whichever used) ##
summary(piwa.abund)
test <-read.csv("piwa_abund.csv",stringsAsFactors = FALSE)
str(test) #y.4 and Noise.4 and Wind.4 and Sky.4 JDate.4 are factors and shouldn't be
piwa.abund<- csvToUMF("piwa_abund.csv", long = FALSE, stringsAsFactors= FALSE, type = "unmarkedFramePCount")
test3 <-read.csv("piwa_abund3.csv")
summary(test3)
str(test3)
piwa.abund3<- csvToUMF("piwa_abund3.csv", long = FALSE, type = "unmarkedFramePCount")
summary(piwa.abund3)
null.piwa <- pcount(~1 ~1, piwa.abund3)
global.piwa <- pcount(~ Treatment + BA + NSnags + Ccover + Ldepth + TreeHt + Age
+ TimeSinceB + Herbicide ~ Noise + Wind + Sky + JDate, piwa.abund3)
global.piwa <- pcount(~ Noise + Wind + Sky + JDate ~ Treatment + BA + NSnags
+ Ccover + Ldepth + TreeHt + Age + TimeSinceB + Herbicide
, piwa.abund3)
global.piwa <- pcount(~ Noise + Wind + Sky + JDate ~ Treatment + BA + Nsnags
+ Ccover + Ldepth + TreeHt + Age + TimeSinceB + Herbicide
, piwa.abund3)
global.piwa <- pcount(~ Noise + Wind + Sky + Jdate ~ Treatment + BA + Nsnags
+ Ccover + Ldepth + TreeHt + Age + TimeSinceB + Herbicide
, piwa.abund3)
local.piwa <- pcount(~ 1 ~ BA + Ccover + TreeHt + Ldepth, piwa.abund3)
lh.piwa <- pcount(~ 1 ~ Ccover + TreeHt + BA, piwa.abund3)
treatment.piwa <- pcount(~ 1 ~ Treatment + BA + TimeSinceB + Herbicide, piwa.abund3)
fms <- fitList(null.piwa, global.piwa, local.piwa, lh.piwa, treatment.piwa)
fms <- fitList(null.piwa, global.piwa, local.piwa, lh.piwa, treatment.piwa)
fms <- fitList(null.piwa, local.piwa, lh.piwa, treatment.piwa)
ms1.piwa <- modSel(fms)
ms1.piwa@Full
ms1.piwa
